<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能监控系统 - 工业自动化平台</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* 状态概览面板 */
        .status-overview {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .status-card {
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            color: white;
            transition: transform 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-5px);
        }

        .status-card.online {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .status-card.warning {
            background: linear-gradient(135deg, #f39c12 0%, #f1c40f 100%);
        }

        .status-card.offline {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .status-card.maintenance {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .status-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .status-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .status-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* 实时监控区域 */
        .monitoring-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
        }

        .chart-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: #f8f9fa;
            color: #6c757d;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .chart-btn.active {
            background: #667eea;
            color: white;
        }

        .chart-btn:hover {
            transform: translateY(-2px);
        }

        /* 设备列表 */
        .device-list {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-height: 600px;
            overflow-y: auto;
        }

        .device-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.3rem;
        }

        .device-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            transition: background-color 0.3s ease;
        }

        .device-item:hover {
            background-color: #f8f9fa;
        }

        .device-item:last-child {
            border-bottom: none;
        }

        .device-info {
            flex: 1;
        }

        .device-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .device-status {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .device-actions {
            display: flex;
            gap: 10px;
        }

        .device-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .btn-view {
            background: #667eea;
            color: white;
        }

        .btn-alert {
            background: #e74c3c;
            color: white;
        }

        .device-btn:hover {
            transform: translateY(-2px);
        }

        /* 预测性维护面板 */
        .maintenance-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .maintenance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .maintenance-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .maintenance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .maintenance-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }

        .maintenance-card.urgent {
            border-left-color: #e74c3c;
            background: #fff5f5;
        }

        .maintenance-card.warning {
            border-left-color: #f39c12;
            background: #fffbf0;
        }

        .maintenance-device {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .maintenance-type {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .maintenance-date {
            color: #667eea;
            font-weight: 500;
        }

        /* 告警面板 */
        .alerts-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .alerts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .alerts-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .alert-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            background: #f8f9fa;
        }

        .alert-item.critical {
            background: #fff5f5;
            border-left: 4px solid #e74c3c;
        }

        .alert-item.warning {
            background: #fffbf0;
            border-left: 4px solid #f39c12;
        }

        .alert-icon {
            font-size: 1.5rem;
            margin-right: 15px;
        }

        .alert-item.critical .alert-icon {
            color: #e74c3c;
        }

        .alert-item.warning .alert-icon {
            color: #f39c12;
        }

        .alert-content {
            flex: 1;
        }

        .alert-message {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .alert-time {
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* 返回按钮 */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(44, 62, 80, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .back-btn:hover {
            background: rgba(44, 62, 80, 1);
            transform: translateY(-2px);
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .monitoring-section {
                grid-template-columns: 1fr;
            }
            
            .status-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <a href="/" class="back-btn">
        <i class="fas fa-arrow-left"></i> 返回首页
    </a>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-tachometer-alt"></i> 智能监控系统</h1>
            <p>实时监控 · 预测性维护 · 智能告警</p>
        </div>

        <!-- 状态概览面板 -->
        <div class="status-overview">
            <div class="status-grid">
                <div class="status-card online">
                    <div class="status-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="status-number" id="onlineDevices">24</div>
                    <div class="status-label">在线设备</div>
                </div>
                <div class="status-card warning">
                    <div class="status-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="status-number" id="warningDevices">3</div>
                    <div class="status-label">告警设备</div>
                </div>
                <div class="status-card offline">
                    <div class="status-icon">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="status-number" id="offlineDevices">1</div>
                    <div class="status-label">离线设备</div>
                </div>
                <div class="status-card maintenance">
                    <div class="status-icon">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="status-number" id="maintenanceDevices">2</div>
                    <div class="status-label">维护中</div>
                </div>
            </div>
        </div>

        <!-- 实时监控区域 -->
        <div class="monitoring-section">
            <!-- 图表区域 -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">实时数据监控</div>
                    <div class="chart-controls">
                        <button class="chart-btn active" onclick="switchChart('temperature')">温度</button>
                        <button class="chart-btn" onclick="switchChart('pressure')">压力</button>
                        <button class="chart-btn" onclick="switchChart('flow')">流量</button>
                        <button class="chart-btn" onclick="switchChart('vibration')">振动</button>
                    </div>
                </div>
                <canvas id="monitoringChart" width="400" height="200"></canvas>
            </div>

            <!-- 设备列表 -->
            <div class="device-list">
                <h3>设备状态</h3>
                <div id="deviceList">
                    <!-- 设备列表将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>

        <!-- 预测性维护面板 -->
        <div class="maintenance-panel">
            <div class="maintenance-header">
                <div class="maintenance-title">预测性维护</div>
                <button class="chart-btn" onclick="refreshMaintenance()">
                    <i class="fas fa-sync-alt"></i> 刷新
                </button>
            </div>
            <div class="maintenance-grid" id="maintenanceGrid">
                <!-- 维护计划将通过JavaScript动态生成 -->
            </div>
        </div>

        <!-- 告警面板 -->
        <div class="alerts-panel">
            <div class="alerts-header">
                <div class="alerts-title">实时告警</div>
                <button class="chart-btn" onclick="clearAlerts()">
                    <i class="fas fa-trash"></i> 清空
                </button>
            </div>
            <div id="alertsList">
                <!-- 告警列表将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>

    <script>
        // 模拟设备数据
        const devices = [
            { id: 1, name: 'PLC-001', status: 'online', type: 'PLC', location: '生产线A' },
            { id: 2, name: '变频器-001', status: 'warning', type: '变频器', location: '生产线A' },
            { id: 3, name: '传感器-001', status: 'online', type: '传感器', location: '生产线B' },
            { id: 4, name: '伺服-001', status: 'maintenance', type: '伺服系统', location: '生产线B' },
            { id: 5, name: 'HMI-001', status: 'offline', type: '人机界面', location: '控制室' },
            { id: 6, name: '执行器-001', status: 'online', type: '执行器', location: '生产线C' }
        ];

        // 模拟维护数据
        const maintenanceData = [
            { device: '变频器-001', type: '预防性维护', date: '2024-08-20', priority: 'urgent' },
            { device: '伺服-001', type: '定期保养', date: '2024-08-25', priority: 'warning' },
            { device: 'PLC-001', type: '软件更新', date: '2024-08-30', priority: 'normal' }
        ];

        // 模拟告警数据
        const alerts = [
            { message: '变频器-001温度过高', time: '2分钟前', type: 'critical' },
            { message: '伺服-001振动异常', time: '5分钟前', type: 'warning' },
            { message: 'HMI-001通信中断', time: '10分钟前', type: 'critical' }
        ];

        let currentChart = null;
        let currentChartType = 'temperature';

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateStatusOverview();
            displayDeviceList();
            displayMaintenanceData();
            displayAlerts();
            initChart();
            startRealTimeUpdates();
        });

        // 更新状态概览
        function updateStatusOverview() {
            const statusCounts = {
                online: devices.filter(d => d.status === 'online').length,
                warning: devices.filter(d => d.status === 'warning').length,
                offline: devices.filter(d => d.status === 'offline').length,
                maintenance: devices.filter(d => d.status === 'maintenance').length
            };

            document.getElementById('onlineDevices').textContent = statusCounts.online;
            document.getElementById('warningDevices').textContent = statusCounts.warning;
            document.getElementById('offlineDevices').textContent = statusCounts.offline;
            document.getElementById('maintenanceDevices').textContent = statusCounts.maintenance;
        }

        // 显示设备列表
        function displayDeviceList() {
            const deviceList = document.getElementById('deviceList');
            deviceList.innerHTML = '';

            devices.forEach(device => {
                const deviceItem = document.createElement('div');
                deviceItem.className = 'device-item';
                
                deviceItem.innerHTML = `
                    <div class="device-info">
                        <div class="device-name">${device.name}</div>
                        <div class="device-status">${device.type} - ${device.location}</div>
                    </div>
                    <div class="device-actions">
                        <button class="device-btn btn-view" onclick="viewDevice(${device.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                        ${device.status === 'warning' ? `
                            <button class="device-btn btn-alert" onclick="viewAlert(${device.id})">
                                <i class="fas fa-exclamation"></i>
                            </button>
                        ` : ''}
                    </div>
                `;
                
                deviceList.appendChild(deviceItem);
            });
        }

        // 显示维护数据
        function displayMaintenanceData() {
            const maintenanceGrid = document.getElementById('maintenanceGrid');
            maintenanceGrid.innerHTML = '';

            maintenanceData.forEach(maintenance => {
                const maintenanceCard = document.createElement('div');
                maintenanceCard.className = `maintenance-card ${maintenance.priority}`;
                
                maintenanceCard.innerHTML = `
                    <div class="maintenance-device">${maintenance.device}</div>
                    <div class="maintenance-type">${maintenance.type}</div>
                    <div class="maintenance-date">计划日期: ${maintenance.date}</div>
                `;
                
                maintenanceGrid.appendChild(maintenanceCard);
            });
        }

        // 显示告警
        function displayAlerts() {
            const alertsList = document.getElementById('alertsList');
            alertsList.innerHTML = '';

            alerts.forEach(alert => {
                const alertItem = document.createElement('div');
                alertItem.className = `alert-item ${alert.type}`;
                
                alertItem.innerHTML = `
                    <div class="alert-icon">
                        <i class="fas fa-${alert.type === 'critical' ? 'exclamation-circle' : 'exclamation-triangle'}"></i>
                    </div>
                    <div class="alert-content">
                        <div class="alert-message">${alert.message}</div>
                        <div class="alert-time">${alert.time}</div>
                    </div>
                `;
                
                alertsList.appendChild(alertItem);
            });
        }

        // 初始化图表
        function initChart() {
            const ctx = document.getElementById('monitoringChart').getContext('2d');
            
            currentChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: generateTimeLabels(),
                    datasets: [{
                        label: '温度 (°C)',
                        data: generateRandomData(),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // 切换图表类型
        function switchChart(type) {
            currentChartType = type;
            
            // 更新按钮状态
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // 更新图表数据
            const labels = {
                temperature: '温度 (°C)',
                pressure: '压力 (MPa)',
                flow: '流量 (L/min)',
                vibration: '振动 (mm/s)'
            };
            
            currentChart.data.datasets[0].label = labels[type];
            currentChart.data.datasets[0].data = generateRandomData();
            currentChart.update();
        }

        // 生成时间标签
        function generateTimeLabels() {
            const labels = [];
            for (let i = 11; i >= 0; i--) {
                const time = new Date();
                time.setMinutes(time.getMinutes() - i * 5);
                labels.push(time.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' }));
            }
            return labels;
        }

        // 生成随机数据
        function generateRandomData() {
            const data = [];
            for (let i = 0; i < 12; i++) {
                data.push(Math.random() * 100 + 20);
            }
            return data;
        }

        // 实时更新
        function startRealTimeUpdates() {
            setInterval(() => {
                // 更新图表数据
                if (currentChart) {
                    currentChart.data.datasets[0].data.shift();
                    currentChart.data.datasets[0].data.push(Math.random() * 100 + 20);
                    currentChart.update('none');
                }
                
                // 更新状态
                updateStatusOverview();
            }, 5000);
        }

        // 查看设备详情
        function viewDevice(id) {
            const device = devices.find(d => d.id === id);
            if (device) {
                alert(`设备详情:\n名称: ${device.name}\n类型: ${device.type}\n位置: ${device.location}\n状态: ${device.status}`);
            }
        }

        // 查看告警
        function viewAlert(id) {
            const device = devices.find(d => d.id === id);
            if (device) {
                alert(`设备告警:\n设备: ${device.name}\n告警类型: 温度过高\n建议: 检查散热系统`);
            }
        }

        // 刷新维护数据
        function refreshMaintenance() {
            displayMaintenanceData();
            alert('维护数据已刷新');
        }

        // 清空告警
        function clearAlerts() {
            if (confirm('确定要清空所有告警吗？')) {
                document.getElementById('alertsList').innerHTML = '<div style="text-align: center; color: #6c757d; padding: 20px;">暂无告警</div>';
            }
        }
    </script>
</body>
</html>



